name: Play YouTube Video (Free Multi-Region)

on:
  workflow_dispatch: # Run manually
  schedule:
    - cron: '0 */6 * * *' # Every 6 hours (FREE: 4 runs/day)

jobs:
  play-usa:
    runs-on: ubuntu-latest
    environment: USA
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install Chrome + Selenium
        run: |
          sudo apt update
          sudo apt install -y chromium-browser
          pip install selenium

      - name: Play YouTube (USA)
        run: |
          python -c "
          from selenium import webdriver
          from selenium.webdriver.chrome.options import Options
          import time, json

          options = Options()
          options.add_argument('--headless')
          options.add_argument('--no-sandbox')
          options.add_argument('--mute-audio')
          options.add_argument('--disable-gpu')
          options.add_argument('--autoplay-policy=no-user-gesture-required')

          driver = webdriver.Chrome(options=options)
          driver.set_window_size(1920, 1080)

          url = 'https://www.youtube.com/watch?v=YOUR_VIDEO_ID'
          print(f'USA: Loading {url}...')
          driver.get(url)
          time.sleep(12)

          try:
            driver.find_element('css selector', '.ytp-large-play-button').click()
          except:
            pass

          print('USA: Playing for 35 minutes...')
          time.sleep(35 * 60)

          print('USA: Done!')
          driver.quit()
          "

  play-uk:
    runs-on: ubuntu-latest
    environment: UK
    needs: play-usa
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install Chrome + Selenium
        run: |
          sudo apt update
          sudo apt install -y chromium-browser
          pip install selenium

      - name: Play YouTube (UK)
        run: |
          python -c "
          from selenium import webdriver
          from selenium.webdriver.chrome.options import Options
          import time

          options = Options()
          options.add_argument('--headless')
          options.add_argument('--no-sandbox')
          options.add_argument('--mute-audio')
          options.add_argument('--disable-gpu')

          driver = webdriver.Chrome(options=options)
          driver.set_window_size(1280, 720)

          url = 'https://www.youtube.com/watch?v=YOUR_VIDEO_ID'
          print(f'UK: Loading {url}...')
          driver.get(url)
          time.sleep(10)

          print('UK: Playing for 40 minutes...')
          time.sleep(40 * 60)

          print('UK: Done!')
          driver.quit()
          "

  play-germany:
    runs-on: ubuntu-latest
    environment: Germany
    needs: play-uk
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install Chrome + Selenium
        run: |
          sudo apt update
          sudo apt install -y chromium-browser
          pip install selenium

      - name: Play YouTube (Germany)
        run: |
          python -c "
          from selenium import webdriver
          from selenium.webdriver.chrome.options import Options
          import time

          options = Options()
          options.add_argument('--headless')
          options.add_argument('--no-sandbox')
          options.add_argument('--mute-audio')

          driver = webdriver.Chrome(options=options)

          url = 'https://www.youtube.com/watch?v=YOUR_VIDEO_ID'
          print(f'Germany: Loading {url}...')
          driver.get(url)
          time.sleep(15)

          print('Germany: Playing for 30 minutes...')
          time.sleep(30 * 60)

          print('Germany: Done!')
          driver.quit()
          "
